/*Copyright (C) 2022-2023 Nurudin Imsirovic <github.com/oxou> Updated: 2023-02-20 03:26 PM*/function hex2bin(n=null){if(null==n)return null;var t=(n=n.toLowerCase()).length;if(t%2)throw"Hexadecimal input string length must be even";for(let r=0;r<t;r++){var e=Number(n.charCodeAt(r));if(!(e>47&&e<58||e>96&&e<103))throw"Input string must be hexadecimal"}var u="";for(let l=0;l<t;l+=2)u+=String.fromCharCode(parseInt(n.substr(l,2),16));return u}function bin2hex(n=null){if(null==n)return null;var t=n.length,r="";for(let e=0;e<t;e++){var u=n.charCodeAt(e).toString(16);2>u.length&&(u="0"+u),r+=u}return r}function hexdec(n=null){return null==n?null:parseInt(n,16)}function dechex(n=null){if(null==n)return null;var t=Number(n).toString(16);return t.length%2&&(t="0"+t),t}function str_split(n,t=1){if(0>=t&&(t=1),1==t)return n.split("");var r=n.length,e=[];for(let u=0;u<r/t;u++)e[u]=n.substr(u*t,t);return e}function clamp(n,t,r){return t>n?t:r<n?r:n}function time(){return Math.floor(Date.now()/1e3)}function time_precise(){return Date.now()}function byte_to_uint8array(n){return n=(n=str_split(n=bin2hex(n),2)).map(n=>hexdec(n)),Uint8Array.from(n)}function uint8array_to_byte(n){return n=(n=(n=[...n]).map(n=>hex2bin(dechex(n).padStart(2,"0")))).join("")}function http_get_bytes(n=null){if(null==n)return!1;var t=new XMLHttpRequest;if(t.open("GET",n,!1),t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),200!=t.status)return null;for(var r=(data=t.response.split("")).length,e=0;e<r;e++){var u=bin2hex(data[e]);u.length>2&&(u=u.substr(2,2),data[e]=hex2bin(u))}return data.join("")}function lerp(n,t,r){return n+(t-n)*r}const bmp_header_parts=[{size:2,data:"BM",addr:0},{addr:2,size:4,data:"\0\0\0\0"},{addr:6,size:2,data:"\0\0"},{addr:8,size:2,data:"\0\0"},{addr:10,size:4,data:"6\0\0\0"},{addr:14,size:4,data:"(\0\0\0"},{addr:18,size:4,data:"\0\0\0\0"},{addr:22,size:4,data:"\0\0\0\0"},{addr:26,size:2,data:"\x01\0"},{addr:28,size:2,data:"\x18\0"},{addr:30,size:4,data:"\0\0\0\0"},{addr:34,size:4,data:"\0\0\0\0"},{addr:38,size:4,data:"\0\0\0\0"},{addr:42,size:4,data:"\0\0\0\0"},{addr:46,size:4,data:"\0\0\0\0"},{addr:50,size:4,data:"\0\0\0\0"},{addr:54,size:-1,data:null}];var bmp_header_parts_size=17;const BMP_HEADER_MAGIC=0,BMP_HEADER_FILESIZE=1,BMP_HEADER_RESERVED1=2,BMP_HEADER_RESERVED2=3,BMP_HEADER_OFFSET=4,BMP_HEADER_HEADERSIZE=5,BMP_HEADER_WIDTH=6,BMP_HEADER_HEIGHT=7,BMP_HEADER_COLORPLANE=8,BMP_HEADER_BITDEPTH=9,BMP_HEADER_COMPRESSION=10,BMP_HEADER_BITMAPSIZE=11,BMP_HEADER_RESHOR=12,BMP_HEADER_RESVER=13,BMP_HEADER_COLORPALETTE=14,BMP_HEADER_IMPORTANTCOLORS=15,BMP_HEADER_DATA=16;function bmp_little_endian_int(e,r=2,a=!0){return e=dechex(e),e=hex2bin(e=(e=(e=str_split(e=a?e.padStart(r,"0"):e.padEnd(r,"0"),2)).reverse()).join(""))}function bmp_little_endian_byte(e){return Number(e=hexdec(e=(e=(e=str_split(e=bin2hex(e),2)).reverse()).join("")))}function bmp_resource_create(e,r){var a=bmp_header_parts,t="",$=e%4,i=bmp_create_array_pixel(e,r),d=e*r*3+r*$;return a.forEach(function($,i){switch(i){case 1:t+=bmp_little_endian_int(d+54,8);return;case 6:t+=bmp_little_endian_int(e,8);return;case 7:t+=bmp_little_endian_int(r,8);return;case 11:t+=bmp_little_endian_int(d,8);return}null!=a[i].data&&(t+=a[i].data)}),{header:byte_to_uint8array(t),header_size:t.length,header_raw:t,width:e,height:r,bitmap:i,bitmap_raw:null,bitmap_size:d,padding:$}}function bmp_resource_valid(e,r=!1){var a=r?e:e.header_raw,t=!1;try{t="B"==a[0]&&"M"==a[1]}catch($){return!1}return t}function bmp_resource_get_pixel(e,r,a){if(r>e.width||a>e.height||0>r||0>a)return[0,0,0];r=3*Math.floor(r),a=Math.abs((a=3*Math.floor(a))-3*e.height+3);var t=(e.width+e.padding/3)*a+r;t=Math.round(t);var $=clamp(Math.floor(Number(e.bitmap[t+0])),0,255),i=clamp(Math.floor(Number(e.bitmap[t+1])),0,255),d=clamp(Math.floor(Number(e.bitmap[t+2])),0,255);return d=isNaN(d)?0:d,i=isNaN(i)?0:i,$=isNaN($)?0:$,[d,i,$]}function bmp_resource_set_pixel(e,r,a,t=null,$=null,i=null){if(r>e.width||a>e.height||0>r||0>a)return!0;t=clamp(Math.floor(Number(t)),0,255),$=clamp(Math.floor(Number($)),0,255),i=clamp(Math.floor(Number(i)),0,255),t=isNaN(t)?0:t,$=isNaN($)?0:$,i=isNaN(i)?0:i,r=3*Math.floor(r),a=Math.abs((a=3*Math.floor(a))-3*e.height+3);var d=(e.width+e.padding/3)*a+r;return d=Math.round(d),e.bitmap[d+0]=i,e.bitmap[d+1]=$,e.bitmap[d+2]=t,!0}function bmp_resource_bitmap_to_bytes(e){var r=e.bitmap,a=e.width,t=e.padding,$="";return r=str_split(r=(r=(r=[...r]).map(e=>dechex(e).padStart(2,"0"))).join(""),6*a),$=String("00").repeat(t),r=hex2bin(r=r.join($)+$),e.bitmap_raw=r,!0}function bmp_resource_get_image_size(e){return!!bmp_resource_valid(e)&&[e.width,e.height]}function bmp_resource_get_image_bitmap(e){return!!bmp_resource_valid(e)&&e.bitmap}function bmp_create_array_pixel(e,r){return new Uint8Array(e*r*3+r*(e%4))}function bmp_create_uri(e){var r=new Blob([e.header,e.bitmap],{type:"image/bmp"});return URL.createObjectURL(r)}function bmp_resource_spawn(e,r=null){if(!bmp_resource_valid(e)||null==r)return!1;var a=document.createElement("img");return a.src=bmp_create_uri(e),r.appendChild(a),a}function bmp_resource_replace(e=null,r){return!!(null!=e&&bmp_resource_valid(r))&&(URL.revokeObjectURL(e.src),e.src=bmp_create_uri(r),!0)}function bmp_resource_filesize(e){var r=e.width,a=e.height;return Number(r*a*3+a*e.padding+54)}function bmp_resource_create_from_bytes(e){if(!bmp_resource_valid(e,!0))return!1;var r=bmp_little_endian_byte(e.substr(10,4));0>=r&&(r=54);for(var a={magic:0,filesize:1,reserved1:2,reserved2:3,offset:4,headersize:5,width:6,height:7,colorplane:8,bitdepth:9,compression:10,bitmapsize:11,reshor:12,resver:13,colorpalette:14,importantcolors:15,data:16},t=0,$=Object.keys(a);t<bmp_header_parts_size;t++)if(void 0!==a[$[t]]){a[$[t]]={};var i=a[$[t]].addr=bmp_header_parts[t].addr,d=a[$[t]].size=bmp_header_parts[t].size;16==t&&(d=e.length-r,i=r),a[$[t]].data=e.substr(i,d)}var n=a.width.data,x=a.height.data,p=a.bitdepth.data,o=a.data.data,s=0;n=bmp_little_endian_byte(n),x=bmp_little_endian_byte(x),p=bmp_little_endian_byte(p),s=n%4,o=byte_to_uint8array(o);var u=bmp_resource_create(n,x);return u.bitmap=o,u}function bmp_resource_request(e=null){return http_get_bytes(e)}function bmp_resource_copy(e){return!!bmp_resource_valid(e)&&structuredClone(e)}function bmp_resource_download(e,r="download.bmp"){if(!bmp_resource_valid(e))return!1;var a=document.createElement("a");return a.href=bmp_create_uri(e),a.download=r,a.style="display:none",document.body.appendChild(a),a.click(),a.remove(),!0}function bmp_plot_rect(_,$=0,t=0,r=10,e=10,o=255,n=255,i=255){for(let l=t;l<e+t;l++)for(let p=$;p<r+$;p++)_.width>p&&_.height>l&&bmp_resource_set_pixel(_,p,l,o,n,i);return!0}function bmp_plot_clear(_,$=0,t=0,r=0){for(let e=0;e<_.height;e++)for(let o=0;o<_.width;o++)bmp_resource_set_pixel(_,o,e,$,t,r);return!0}function bmp_plot_line(_,$,t,r,e,o=255,n=255,i=255,l=1){l=clamp(l,.1,2);var p=r-$,f=e-t,h=Math.sqrt(p*p+f*f)*l,u=p/h,a=f/h;p=$,f=t;for(let c=0;c<h;c++)_.width>p&&_.height>f&&bmp_resource_set_pixel(_,p,f,o,n,i),p+=u,f+=a;return!0}function bmp_plot_resource(_,$,t=0,r=0,e=-1,o=-1,n=0,i=0,l=!1,p=-1,f=-1,h=-1){var $=structuredClone($);e=clamp(e,-1,$.width),o=clamp(o,-1,$.height),-1==e&&(e=$.width),-1==o&&(o=$.height);for(let u=0;u<e;u++)for(let a=0;a<o;a++)if(_.width>u+t&&_.height>a+r){var c=bmp_resource_get_pixel($,u+n,a+i);if(l&&c[0]==p&&c[1]==f&&c[2]==h)continue;bmp_resource_set_pixel(_,u+t,a+r,c[0],c[1],c[2])}return!0}function bmp_plot_text(_,$,t,r,e="A",o=!0,n=255,i=255,l=255,p=-1,f=-1,h=-1){var u=t,a=t,c=r,v=0,b=0,m=$.width/96,w=$.height,d=$.width/m,g=e.length;for(let s=0;s<g;s++){var x=e.charCodeAt(s),A=(x-32)*m;if(10==x||13==x){a=u,c+=w;continue}(32>x||x>126)&&(A=m*(d-1)),o&&a+m>_.width&&(a=u,c+=w);for(let q=b;q<w;q++)for(let C=v;C<m;C++){var E=bmp_resource_get_pixel($,C+A,q);if(255==E[0]&&255==E[1]&&255==E[2]){if(-1==n||-1==i||-1==l)continue;E[0]=n,E[1]=i,E[2]=l}else if(0==E[0]&&0==E[1]&&0==E[2]){if(-1==p||-1==f||-1==f)continue;E[0]=p,E[1]=f,E[2]=h}_.width>a+C&&_.height>c+q&&bmp_resource_set_pixel(_,a+C,c+q,E[0],E[1],E[2])}a+=m}return!0}function bmp_plot_circle(_,$,t,r,e,o,n,i,l=1){var p=[[247,1],[312,8],[360,23],[403,47],[439,78],[469,114],[490,153],[507,205],[511,257],[505,312],[490,360],[466,403],[435,439],[399,469],[360,490],[308,507],[256,511],[201,505],[153,490],[110,466],[74,435],[44,399],[23,360],[6,308],[2,256],[8,201],[23,153],[47,110],[78,74],[114,44],[153,23],[205,6],[247,1]];for(let f=1;f<33;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_arrow_up(_,$,t,r,e,o,n,i,l=1){var p=[[256,1],[512,256],[384,256],[384,512],[128,512],[128,256],[1,256],[256,1]];for(let f=1;f<8;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_arrow_down(_,$,t,r,e,o,n,i,l=1){var p=[[128,0],[384,0],[384,256],[512,256],[256,512],[0,256],[128,256],[128,0]];for(let f=1;f<8;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_arrow_left(_,$,t,r,e,o,n,i,l=1){var p=[[0,256],[256,0],[256,128],[512,128],[512,384],[256,384],[256,512],[0,256]];for(let f=1;f<8;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_arrow_right(_,$,t,r,e,o,n,i,l=1){var p=[[0,128],[256,128],[256,0],[512,256],[256,512],[256,384],[0,384],[0,128]];for(let f=1;f<8;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_triangle(_,$,t,r,e,o,n,i,l=1){var p=[[256,0],[512,512],[0,512],[256,0]];for(let f=1;f<4;f++){var h,u=p[f-1],a=p[f],c=u[0]/512*r+$,v=u[1]/512*e+t;bmp_plot_line(_,c,v,a[0]/512*r+$,a[1]/512*e+t,o,n,i,l)}return!0}function bmp_plot_fill(_,$,t,r,e,o,n=null){var i=[];i.push([$,t]);var l=bmp_resource_get_pixel(_,$,t);if(null===n&&(n=bmp_resource_set_pixel),l[0]!=r||l[1]!=e||l[2]!=o){for(;i.length>0;){var[$,t]=i.pop(),p=bmp_resource_get_pixel(_,$,t);!(0>$)&&!($>_.width)&&!(0>t)&&!(t>_.height)&&p[0]==l[0]&&p[1]==l[1]&&p[2]==l[2]&&(n(_,$,t,r,e,o),i.push([$+1,t]),i.push([$-1,t]),i.push([$,t+1]),i.push([$,t-1]))}return!0}}function bmp_mod_get_channel(_,$=0){$=clamp($,0,2);var r=bmp_resource_create(_.width,_.height);for(let o=0;o<_.height;o++)for(let t=0;t<_.width;t++){var n=bmp_resource_get_pixel(_,t,o);bmp_resource_set_pixel(r,t,o,n[$],n[$],n[$])}return r}function bmp_mod_dissect_font(_){var $=_.width/96,r=_.height,o=_.width/$;return[$,r,o]}function bmp_mod_flip_x(_){var $=_.width,r=_.height,o=bmp_resource_create($,r);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);bmp_resource_set_pixel(o,Math.abs($-n)-1,t,e[0],e[1],e[2])}return o}function bmp_mod_flip_y(_){var $=_.width,r=_.height,o=bmp_resource_create($,r);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);bmp_resource_set_pixel(o,n,Math.abs(r-t)-1,e[0],e[1],e[2])}return o}function bmp_mod_rotate_right(_){var $=_.width,r=_.height,o=bmp_resource_create(r,$);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);bmp_resource_set_pixel(o,Math.abs(r-t)-1,n,e[0],e[1],e[2])}return o}function bmp_mod_rotate_left(_){var $=_.width,r=_.height,o=bmp_resource_create(r,$);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);bmp_resource_set_pixel(o,t,Math.abs($-n)-1,e[0],e[1],e[2])}return o}function bmp_mod_replace_color(_,$,r,o,t,n,e){var i=_.width,a=_.height,m=bmp_resource_copy(_);for(let l=0;l<a;l++)for(let f=0;f<i;f++){var d=bmp_resource_get_pixel(_,f,l);d[0]==$&&d[1]==r&&d[2]==o&&bmp_resource_set_pixel(m,f,l,t,n,e)}return m}function bmp_mod_noise_grayscale(_,$=.1){$=clamp($,0,10);var r=_.width,o=_.height,t=bmp_resource_copy(_);for(let n=0;n<o;n++)for(let e=0;e<r;e++){var i=bmp_resource_get_pixel(_,e,n),a=Math.floor(Math.random(0)*(255*$));i[0]=clamp(i[0]+a,0,255),i[1]=clamp(i[1]+a,0,255),i[2]=clamp(i[2]+a,0,255),bmp_resource_set_pixel(t,e,n,i[0],i[1],i[2])}return t}function bmp_mod_noise_rgb(_,$=.1){$=clamp($,0,10);var r=_.width,o=_.height,t=bmp_resource_copy(_);for(let n=0;n<o;n++)for(let e=0;e<r;e++){var i=bmp_resource_get_pixel(_,e,n),a=Math.floor(Math.random(0)*(255*$)),m=Math.floor(Math.random(0)*(255*$)),l=Math.floor(Math.random(0)*(255*$));i[0]=clamp(i[0]+a,0,255),i[1]=clamp(i[1]+m,0,255),i[2]=clamp(i[2]+l,0,255),bmp_resource_set_pixel(t,e,n,i[0],i[1],i[2])}return t}function bmp_mod_color_invert(_){var $=_.width,r=_.height,o=bmp_resource_copy(_);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);e[0]=Math.abs(e[0]-255),e[1]=Math.abs(e[1]-255),e[2]=Math.abs(e[2]-255),bmp_resource_set_pixel(o,n,t,e[0],e[1],e[2])}return o}function bmp_mod_color_grayscale(_){var $=_.width,r=_.height,o=bmp_resource_create($,r);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t),e=clamp((e[0]+e[1]+e[2])/3,0,255);bmp_resource_set_pixel(o,n,t,e,e,e)}return o}function bmp_mod_color_1bit(_){var $=_.width,r=_.height,o=bmp_resource_create($,r);for(let t=0;t<r;t++)for(let n=0;n<$;n++){var e=bmp_resource_get_pixel(_,n,t);e=(e=clamp((e[0]+e[1]+e[2])/3,0,255))>127?255:0,bmp_resource_set_pixel(o,n,t,e,e,e)}return o}function bmp_mod_noise_grayscale(_,$=.1){$=clamp($,0,10);var r=_.width,o=_.height,t=bmp_resource_copy(_);for(let n=0;n<o;n++)for(let e=0;e<r;e++){var i=bmp_resource_get_pixel(_,e,n),a=Math.floor(Math.random(0)*(255*$));i[0]=clamp(i[0]+a,0,255),i[1]=clamp(i[1]+a,0,255),i[2]=clamp(i[2]+a,0,255),bmp_resource_set_pixel(t,e,n,i[0],i[1],i[2])}return t}function bmp_mod_noise_rgb(_,$=.1){$=clamp($,0,10);var r=_.width,o=_.height,t=bmp_resource_copy(_);for(let n=0;n<o;n++)for(let e=0;e<r;e++){var i=bmp_resource_get_pixel(_,e,n),a=Math.floor(Math.random(0)*(255*$)),m=Math.floor(Math.random(0)*(255*$)),l=Math.floor(Math.random(0)*(255*$));i[0]=clamp(i[0]+a,0,255),i[1]=clamp(i[1]+m,0,255),i[2]=clamp(i[2]+l,0,255),bmp_resource_set_pixel(t,e,n,i[0],i[1],i[2])}return t}function bmp_mod_apply_convolution_matrix(_,$=[0,0,0,0,0,0,0,0,0],r=1,o=0){if(9!=$.length&&25!=$.length)throw"Convolution matrix must be of size 3x3 (9) or 5x5 (25)";var t=bmp_resource_copy(_),n=_.width,e=_.height,i=$;if(9==$.length)for(let a=0;a<n;a++)for(let m=0;m<e;m++){var l=bmp_resource_get_pixel(_,a-1,m-1),f=bmp_resource_get_pixel(_,a,m-1),d=bmp_resource_get_pixel(_,a+1,m-1),u=bmp_resource_get_pixel(_,a-1,m),h=bmp_resource_get_pixel(_,a,m),p=bmp_resource_get_pixel(_,a+1,m),v=bmp_resource_get_pixel(_,a-1,m+1),b=bmp_resource_get_pixel(_,a,m+1),c=bmp_resource_get_pixel(_,a+1,m+1);l[0]*=i[0],l[1]*=i[0],l[2]*=i[0],f[0]*=i[1],f[1]*=i[1],f[2]*=i[1],d[0]*=i[2],d[1]*=i[2],d[2]*=i[2],u[0]*=i[3],u[1]*=i[3],u[2]*=i[3],h[0]*=i[4],h[1]*=i[4],h[2]*=i[4],p[0]*=i[5],p[1]*=i[5],p[2]*=i[5],v[0]*=i[6],v[1]*=i[6],v[2]*=i[6],b[0]*=i[7],b[1]*=i[7],b[2]*=i[7],c[0]*=i[8],c[1]*=i[8],c[2]*=i[8];var g=[(l[0]+f[0]+d[0]+u[0]+h[0]+p[0]+v[0]+b[0]+c[0])/r,(l[1]+f[1]+d[1]+u[1]+h[1]+p[1]+v[1]+b[1]+c[1])/r,(l[2]+f[2]+d[2]+u[2]+h[2]+p[2]+v[2]+b[2]+c[2])/r];bmp_resource_set_pixel(t,a,m,g[0]+o,g[1]+o,g[2]+o)}if(25==$.length)for(let s=0;s<n;s++)for(let w=0;w<e;w++){var l=bmp_resource_get_pixel(_,s-2,w-2),f=bmp_resource_get_pixel(_,s-1,w-2),d=bmp_resource_get_pixel(_,s,w-2),x=bmp_resource_get_pixel(_,s+1,w-2),y=bmp_resource_get_pixel(_,s+2,w-2),u=bmp_resource_get_pixel(_,s-2,w-1),h=bmp_resource_get_pixel(_,s-1,w-1),p=bmp_resource_get_pixel(_,s,w-1),z=bmp_resource_get_pixel(_,s+1,w-1),C=bmp_resource_get_pixel(_,s+2,w-1),v=bmp_resource_get_pixel(_,s-2,w),b=bmp_resource_get_pixel(_,s-1,w),c=bmp_resource_get_pixel(_,s,w),j=bmp_resource_get_pixel(_,s+1,w),k=bmp_resource_get_pixel(_,s+2,w),q=bmp_resource_get_pixel(_,s-2,w+1),A=bmp_resource_get_pixel(_,s-1,w+1),B=bmp_resource_get_pixel(_,s,w+1),D=bmp_resource_get_pixel(_,s+1,w+1),E=bmp_resource_get_pixel(_,s+2,w+1),F=bmp_resource_get_pixel(_,s-2,w+2),G=bmp_resource_get_pixel(_,s-1,w+2),H=bmp_resource_get_pixel(_,s,w+2),I=bmp_resource_get_pixel(_,s+1,w+2),J=bmp_resource_get_pixel(_,s+2,w+2);l[0]*=i[0],l[1]*=i[0],l[2]*=i[0],f[0]*=i[1],f[1]*=i[1],f[2]*=i[1],d[0]*=i[2],d[1]*=i[2],d[2]*=i[2],x[0]*=i[3],x[1]*=i[3],x[2]*=i[3],y[0]*=i[4],y[1]*=i[4],y[2]*=i[4],u[0]*=i[5],u[1]*=i[5],u[2]*=i[5],h[0]*=i[6],h[1]*=i[6],h[2]*=i[6],p[0]*=i[7],p[1]*=i[7],p[2]*=i[7],z[0]*=i[8],z[1]*=i[8],z[2]*=i[8],C[0]*=i[9],C[1]*=i[9],C[2]*=i[9],v[0]*=i[10],v[1]*=i[10],v[2]*=i[10],b[0]*=i[11],b[1]*=i[11],b[2]*=i[11],c[0]*=i[12],c[1]*=i[12],c[2]*=i[12],j[0]*=i[13],j[1]*=i[13],j[2]*=i[13],k[0]*=i[14],k[1]*=i[14],k[2]*=i[14],q[0]*=i[15],q[1]*=i[15],q[2]*=i[15],A[0]*=i[16],A[1]*=i[16],A[2]*=i[16],B[0]*=i[17],B[1]*=i[17],B[2]*=i[17],D[0]*=i[18],D[1]*=i[18],D[2]*=i[18],E[0]*=i[19],E[1]*=i[19],E[2]*=i[19],F[0]*=i[20],F[1]*=i[20],F[2]*=i[20],G[0]*=i[21],G[1]*=i[21],G[2]*=i[21],H[0]*=i[22],H[1]*=i[22],H[2]*=i[22],I[0]*=i[23],I[1]*=i[23],I[2]*=i[23],J[0]*=i[24],J[1]*=i[24],J[2]*=i[24];var g=[(l[0]+f[0]+d[0]+x[0]+y[0]+u[0]+h[0]+p[0]+z[0]+C[0]+v[0]+b[0]+c[0]+j[0]+k[0]+q[0]+A[0]+B[0]+D[0]+E[0]+F[0]+G[0]+H[0]+I[0]+J[0])/r,(l[1]+f[1]+d[1]+x[1]+y[1]+u[1]+h[1]+p[1]+z[1]+C[1]+v[1]+b[1]+c[1]+j[1]+k[1]+q[1]+A[1]+B[1]+D[1]+E[1]+F[1]+G[1]+H[1]+I[1]+J[1])/r,(l[2]+f[2]+d[2]+x[2]+y[2]+u[2]+h[2]+p[2]+z[2]+C[2]+v[2]+b[2]+c[2]+j[2]+k[2]+q[2]+A[2]+B[2]+D[2]+E[2]+F[2]+G[2]+H[2]+I[2]+J[2])/r,];bmp_resource_set_pixel(t,s,w,g[0]+o,g[1]+o,g[2]+o)}return t}function bmp_mod_sharpen(_){var $=bmp_resource_copy(_);return bmp_mod_apply_convolution_matrix($,[0,-1,0,-1,5,-1,0,-1,0])}function bmp_mod_resize(_,$,r){if($=Math.round($),r=Math.round(r),$==_.width&&r==_.height)return _;var o=bmp_resource_create($,r);xd=_.width/$,yd=_.height/r;for(let t=0;t<$;t++)for(let n=0;n<r;n++){var e=bmp_resource_get_pixel(_,xd*t,yd*n);for(let i=0;i<xd;i+=xd)for(let a=0;a<yd;a+=yd)bmp_resource_set_pixel(o,t+i,n+a,e[0],e[1],e[2])}return o}function bmp_mod_pixelate(_,$=2){if(1==($=Math.round(clamp($,1))))return _;var r=bmp_resource_copy(bmp_resource),o=_.width,t=_.height,n=clamp(Math.round(o/$),1),e=clamp(Math.round(t/$),1);return r=bmp_mod_resize(r,n,e),r=bmp_mod_resize(r,o,t)}function bmp_mod_crop(_,$=0,r=0,o=1,t=1,n=0){$=Math.round(Math.abs($)),r=Math.round(Math.abs(r)),o=Math.round(Math.abs(o)),t=Math.round(Math.abs(t)),!n&&($==o&&++o,r==t&&++t,$>o&&(tx=$,$=o,o=tx),r>t&&(ty=r,r=t,t=ty)),n||(o=clamp(o,0,_.width),t=clamp(t,0,_.height)),n?(e=o,i=t):(e=Math.round(o-$),i=Math.round(t-r));var e,i,a=bmp_resource_create(e,i),m=e+$,l=i+r;for(let f=$;f<m;f++)for(let d=r;d<l;d++){var u=bmp_resource_get_pixel(_,f,d);bmp_resource_set_pixel(a,f-$,d-r,u[0],u[1],u[2])}return a}function bmp_mod_detect_edge(_,$=0){$=clamp($,0,2);var r=bmp_resource_copy(_);return 0==$&&(r=bmp_mod_apply_convolution_matrix(r,[1,0,-1,0,0,0,-1,0,1])),1==$&&(r=bmp_mod_apply_convolution_matrix(r,[0,1,0,1,-4,1,0,1,0])),2==$&&(r=bmp_mod_apply_convolution_matrix(r,[-1,-1,-1,-1,8,-1,-1,-1,-1])),r}function bmp_mod_blur_box(_){var $=bmp_resource_copy(_);return bmp_mod_apply_convolution_matrix($,[1,1,1,1,1,1,1,1,1],9)}function bmp_mod_blur_gaussian(_){var $=bmp_resource_copy(_);return bmp_mod_apply_convolution_matrix($,[1,2,1,2,4,2,1,2,1],16)}function bmp_mod_emboss(_){var $=bmp_resource_copy(_);return bmp_mod_apply_convolution_matrix($,[-2,-1,0,-1,1,1,0,1,2],9)}